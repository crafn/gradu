int printf(const char *fmt, ..);

typedef float field(2) Field;

int main(int argc, char **argv)
{
	Field a;
	Field b;
	int i;
	a = alloc_field(20, 20);
	b = alloc_field(20, 20);

	for (i = 0; i < 10; ++i) {
		Field *input = &a;
		Field *output = &b;

		// Swap
		if (i % 2 == 1) {
			Field *tmp = output;
			output = input;
			input = output;
		}

		/*
		for_fields (*output, *input) {
			// Some kind of diffusion for test simulation
			output(x, y) =	input(x, y) +
							input(x + 1, y) +
							input(x + 1, y + 1) +
							input(x, y + 1);
			output(x, y) /= 4.0;
		}
		*/

	}

	free_field(a);
	free_field(b);
	return 0;
}

