int printf(const char *fmt, ..);

int main(int argc, char **argv)
{
	// Not yet a simulation!
	int field(2 + 1) test_field;
	float matrix(2, 2) field(2) test_field2;

	int matrix(2, 2) mat1;
	int matrix(2, 2) mat2;
	int matrix(2, 2) mat3;
	int matrix(2, 2) result;
	float matrix(2, 2) test;

	mat1(0, 0) = 1;
	mat1(1, 0) = -1 + -2 * -3;
	mat1(0, 1) = 3;
	mat1(1, 1) = 4;

	mat2(0, 0) = 5;
	mat2(1, 0) = 5;
	mat2(0, 1) = 5;
	mat2(1, 1) = 6;

	mat3(0, 0) = 1;
	mat3(1, 0) = 1;
	mat3(0, 1) = 2;
	mat3(1, 1) = 3;


	test_field = alloc_field(100, 100, 100);
	test_field2 = alloc_field(200, 200);

	test_field(1, 2, 3) = 4;
	test_field2(1, 2) = test;

	test_field2(13, 37)(1, 0) = 3;

	// This comment should survive to the generated code
	result = mat1 * mat2 * mat3;
	test = test_field2(0, 0) * test_field2(1, 1);

	printf("(%i, %i)\n(%i, %i)\n", result(0, 0), result(1, 0), result(0, 1), result(1, 1));

	free_field(test_field);
	free_field(test_field2);

	return 0;
}

